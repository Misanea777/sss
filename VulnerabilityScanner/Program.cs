using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using System.Windows.Forms;
using System.Xml;
using VulnerabilityScanner.Backend.Executors;
using VulnerabilityScanner.Backend.Policies;

namespace VulnerabilityScanner
{
    static class Program
    {
        /// <summary>
        /// The main entry point for the application.
        /// </summary>
        [STAThread]
        static void Main()
        {
            Backup.createBackup();

            /*            //
                        IniFile f = IniFile.Load("backup_pol.inf");
                        IDictionary<string, IniSection> d = f.Sections;
                        IniSection s = d["System Access"];
                        s["MaximumPasswordAge"] = "2";
                        string g = s["MaximumPasswordAge"];
                        Console.WriteLine(g);
                        //f.createInf("toBeExportexd");
                        //*/

            Controller controller = new Controller();
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new Form1(controller));

            //Testing
            /*            XmlDocument doc;
                        doc = Serializer.fromAuditToXml(@"C:\Users\misanea\Desktop\test.audit");
                        doc.Save("hehe" + ".xml");*/

            /*            XmlDocument uploadedDoc = new XmlDocument();
                        uploadedDoc.Load("hehe" + ".xml");
                        List<Policy> p = new List<Policy>();
                        p = Serializer.deserealizeFromXml(uploadedDoc);*/

            /*            XmlDocument xmlFromObj = new XmlDocument();
                        Serializer.serializeToXml(xmlFromObj, p);
                        xmlFromObj.Save("iobana" + ".xml");*/

            //CommandExecutor.ExecuteCommand("secedit.exe /export /cfg extracted_pol.inf");

            /*            var file = IniFile.Load("extracted_pol.inf");
                        Scaner.scan(file ,p);*/

        }
    }
    
}
