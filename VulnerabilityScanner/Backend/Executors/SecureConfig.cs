using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using VulnerabilityScanner.Backend.Policies;

namespace VulnerabilityScanner.Backend.Executors
{
    class SecureConfig
    {
        public static void enforcePolicies(IniFile file, List<Policy> policies)
        {
            foreach(Policy policy in policies)
            {
                policy.enforce(file);
            }
            file.createInf("toBeEnforced");

            Console.WriteLine(CommandExecutor.ExecuteCommand("secedit.exe /configure /db %windir%\\security\\local.sdb /cfg toBeEnforced.inf"));
        }
    }
}
