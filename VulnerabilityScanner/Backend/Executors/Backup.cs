using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace VulnerabilityScanner.Backend.Executors
{
    public class Backup
    {
        public static void createBackup()
        {
            createSecBackup();
            createAuditBackup();
            createRegBackup();
        }

        public static void createSecBackup()
        {
            CommandExecutor.ExecuteCommand("secedit.exe /export /cfg backup_pol.inf");
        }

        public static void createRegBackup()
        {
            
            Console.WriteLine(CommandExecutor.ExecuteCommand("reg export HKLM backup_reg.reg /y"));
        }

        public static void createAuditBackup()
        {
            CommandExecutor.ExecuteCommand("auditpol /backup /file:backup_aud.csv");
        }

        public static void rollBack() 
        {
            Console.WriteLine(CommandExecutor.ExecuteCommand("secedit.exe /configure /db %windir%\\security\\local.sdb /cfg backup_pol.inf"));
            Console.WriteLine(CommandExecutor.ExecuteCommand("auditpol /restore /file:backup_aud.csv"));
            Console.WriteLine(CommandExecutor.ExecuteCommand("reg import backup_reg.reg"));
            
        }
    }
}
